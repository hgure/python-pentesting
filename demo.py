#!/usr/bin/env python3
"""Command-line interface to perform several security tests."""


import nmap3
import whois
import typer

app = typer.Typer()


@app.command()
def domain(name: str):
    """Print the domain registrant's name and organization."""
    results = whois.whois(name)
    print(f"{name} is registered by {results.name} - {results.org}")


@app.command()
def portscan(target: str, top: int = 10):
    """Perform a portscan against a target on the top TOP ports,
    and print the open ports and services."""
    nmap = nmap3.Nmap()
    results = nmap.scan_top_ports(target, default=top)
    ip, *_unused = results.keys()
    for port in results[ip]["ports"]:
        if "open" in port["state"]:
            print(f"{port['portid']} {port['service']['name']}")


if __name__ == "__main__":
    app()

"""This script is a command-line interface that uses the typer library to perform several security tests. It has two commands: "domain" and "portscan". The "domain" command takes a single argument, the name of a domain, and prints the domain registrant's name and organization by using the whois library. The "portscan" command takes two arguments, the target IP address or hostname and an optional argument "top" (default=10) which is the number of top ports to scan. It uses the nmap3 library to perform a port scan on the target and prints the open ports and services. The script will run when called as the main program."""
